<script setup lang="ts">
  import { ref, unref } from 'vue'
  import OutlineButton from '@/components/base/buttons/OutlineButton.vue'
  import PrimaryButton from '@/components/base/buttons/PrimaryButton.vue'
  import { useNavigation } from '@/composables/navigation.ts'
  import { useI18n } from 'vue-i18n'
  import { ElPopover } from 'element-plus'

  const { t } = useI18n()

  const { navigateToSupport, navigateToConvert, navigateToHome } = useNavigation()

  const { isDisplayDashboard = false } = defineProps<{
    isDisplayDashboard?: boolean
  }>()

  defineEmits(['click'])

  const isShow = ref<boolean>(false)

  const burgerPopover = ref<InstanceType<typeof ElPopover> | null>(null)

  const closePopover = () => {
    burgerPopover.value?.hide()
  }
</script>

<template>
  <el-popover
    ref="burgerPopover"
    placement="bottom"
    :width="255"
    trigger="click"
    popper-class="burger-popover"
    @show="() => (isShow = true)"
    @hide="() => (isShow = false)"
  >
    <template #reference>
      <button class="burger-button">
        <template v-if="!isShow">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="40"
            height="40"
            viewBox="0 0 40 40"
            fill="none"
          >
            <path
              d="M18.608 10.9372V12.6668C18.6062 14.2409 17.9819 15.75 16.8719 16.8631C15.762 17.9761 14.2572 18.6022 12.6875 18.604H9.92044C8.35079 18.6022 6.84594 17.9761 5.73603 16.863C4.62612 15.75 4.00179 14.2409 4 12.6668V10.9372C4.00177 9.36313 4.6261 7.854 5.73601 6.74094C6.84592 5.62787 8.35078 5.00178 9.92044 5H12.6875C14.2572 5.00178 15.762 5.62787 16.8719 6.74093C17.9819 7.85399 18.6062 9.36312 18.608 10.9372ZM12.6875 21.396H9.92044C8.35078 21.3977 6.84592 22.0239 5.73601 23.1369C4.62609 24.25 4.00177 25.7591 4 27.3332V29.0628C4.00177 30.6369 4.6261 32.146 5.73601 33.2591C6.84592 34.3721 8.35078 34.9982 9.92044 35H12.6875C14.2572 34.9982 15.762 34.3721 16.8719 33.2591C17.9819 32.146 18.6062 30.6369 18.608 29.0628V27.3332C18.6062 25.7591 17.9819 24.25 16.872 23.1369C15.762 22.0239 14.2572 21.3977 12.6875 21.396ZM30.0796 21.396H27.3125C25.7428 21.3977 24.238 22.0239 23.1281 23.1369C22.0182 24.25 21.3938 25.7591 21.3921 27.3332V29.0628C21.3938 30.6369 22.0182 32.146 23.1281 33.2591C24.238 34.3721 25.7428 34.9982 27.3125 35H30.0796C31.6492 34.9982 33.1541 34.3721 34.264 33.2591C35.3739 32.146 35.9982 30.6369 36 29.0628V27.3332C35.9982 25.7591 35.3739 24.25 34.264 23.1369C33.1541 22.0239 31.6492 21.3977 30.0796 21.396ZM36 10.9372V12.6668C35.9982 14.2409 35.3739 15.75 34.264 16.863C33.1541 17.9761 31.6492 18.6022 30.0796 18.604H27.3125C25.7428 18.6022 24.238 17.9761 23.1281 16.8631C22.0182 15.75 21.3938 14.2409 21.3921 12.6668V10.9372C21.3938 9.36313 22.0182 7.854 23.1281 6.74094C24.238 5.62787 25.7428 5.00178 27.3125 5H30.0796C31.6492 5.00178 33.1541 5.62787 34.264 6.74094C35.3739 7.854 35.9982 9.36313 36 10.9372ZM34.125 10.9372C34.1238 9.86165 33.6972 8.83046 32.9388 8.0699C32.1804 7.30934 31.1521 6.88153 30.0796 6.88032H27.3125C26.24 6.88153 25.2117 7.30934 24.4533 8.0699C23.6949 8.83046 23.2683 9.86165 23.2671 10.9372V12.6668C23.2683 13.7423 23.6949 14.7735 24.4533 15.5341C25.2117 16.2946 26.24 16.7225 27.3125 16.7237H30.0796C31.1521 16.7225 32.1804 16.2946 32.9388 15.5341C33.6972 14.7735 34.1238 13.7423 34.125 12.6668V10.9372Z"
              fill="#0B0F16"
            />
          </svg>
        </template>
        <template v-else>
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="40"
            height="40"
            viewBox="0 0 40 40"
            fill="none"
          >
            <path
              d="M18.608 10.9372V12.6668C18.6062 14.2409 17.9819 15.75 16.8719 16.8631C15.762 17.9761 14.2572 18.6022 12.6875 18.604H9.92044C8.35079 18.6022 6.84594 17.9761 5.73603 16.863C4.62612 15.75 4.00179 14.2409 4 12.6668V10.9372C4.00177 9.36313 4.6261 7.854 5.73601 6.74094C6.84592 5.62787 8.35078 5.00178 9.92044 5H12.6875C14.2572 5.00178 15.762 5.62787 16.8719 6.74093C17.9819 7.85399 18.6062 9.36312 18.608 10.9372ZM12.6875 21.3959H9.92044C8.35078 21.3977 6.84592 22.0239 5.73601 23.1369C4.62609 24.25 4.00177 25.7591 4 27.3332V29.0628C4.00177 30.6369 4.6261 32.146 5.73601 33.2591C6.84592 34.3721 8.35078 34.9982 9.92044 35H12.6875C14.2572 34.9982 15.762 34.3721 16.8719 33.2591C17.9819 32.146 18.6062 30.6369 18.608 29.0628V27.3332C18.6062 25.7591 17.9819 24.25 16.872 23.1369C15.762 22.0238 14.2572 21.3977 12.6875 21.3959ZM30.0796 21.3959H27.3125C25.7428 21.3977 24.238 22.0239 23.1281 23.1369C22.0182 24.25 21.3938 25.7591 21.3921 27.3332V29.0628C21.3938 30.6369 22.0182 32.146 23.1281 33.2591C24.238 34.3721 25.7428 34.9982 27.3125 35H30.0796C31.6492 34.9982 33.1541 34.3721 34.264 33.2591C35.3739 32.146 35.9982 30.6369 36 29.0628V27.3332C35.9982 25.7591 35.3739 24.25 34.264 23.1369C33.1541 22.0239 31.6492 21.3977 30.0796 21.3959ZM36 10.9372V12.6668C35.9982 14.2409 35.3739 15.75 34.264 16.863C33.1541 17.9761 31.6492 18.6022 30.0796 18.604H27.3125C25.7428 18.6022 24.238 17.9761 23.1281 16.8631C22.0182 15.75 21.3938 14.2409 21.3921 12.6668V10.9372C21.3938 9.36313 22.0182 7.854 23.1281 6.74094C24.238 5.62787 25.7428 5.00178 27.3125 5H30.0796C31.6492 5.00178 33.1541 5.62787 34.264 6.74094C35.3739 7.854 35.9982 9.36313 36 10.9372ZM34.125 10.9372C34.1238 9.86165 33.6972 8.83046 32.9388 8.0699C32.1804 7.30934 31.1521 6.88153 30.0796 6.88032H27.3125C26.24 6.88153 25.2117 7.30934 24.4533 8.0699C23.6949 8.83046 23.2683 9.86165 23.2671 10.9372V12.6668C23.2683 13.7423 23.6949 14.7735 24.4533 15.5341C25.2117 16.2946 26.24 16.7225 27.3125 16.7237H30.0796C31.1521 16.7225 32.1804 16.2946 32.9388 15.5341C33.6972 14.7735 34.1238 13.7423 34.125 12.6668V10.9372Z"
              fill="#0B0F16"
            />
            <path
              d="M27.3125 5H30.0796C31.6493 5.00179 33.1541 5.6279 34.264 6.74097C35.3739 7.85405 35.9983 9.36318 36 10.9373V12.6668C35.9983 14.2409 35.3739 15.75 34.264 16.8631C33.1541 17.9762 31.6492 18.6023 30.0796 18.6041H27.3125C25.7429 18.6023 24.238 17.9762 23.1281 16.8631C22.0182 15.75 21.3939 14.2409 21.3921 12.6668V10.9373C21.3939 9.36318 22.0182 7.85405 23.1281 6.74097C24.238 5.6279 25.7429 5.00179 27.3125 5Z"
              fill="#0B0F16"
            />
          </svg>
        </template>
      </button>
    </template>
    <template #default>
      <div class="burger-content">
        <OutlineButton  @click="() => {closePopover(); navigateToSupport() }">
          {{ t('header_menu_partner') }}
        </OutlineButton>
        <PrimaryButton @click="() => {closePopover(); navigateToHome() }" v-if="isDisplayDashboard" >
          {{ t('header_menu_home') }}
        </PrimaryButton>
      </div>
    </template>
  </el-popover>
</template>

<style lang="scss">
  .el-popper.burger-popover {
    background-color: transparent !important;
    padding: 10px 0 0 0;
    box-shadow: none !important;
    border: none !important;
    outline: none !important;

    .el-popper__arrow {
      display: none !important;
      &:before {
        background-color: transparent !important;
      }
    }
  }
</style>

<style scoped lang="scss">
  .burger-button {
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    width: 40px;
    background-color: transparent;

    svg {
      width: 100%;
    }
  }

  .burger-content {
    border-radius: 20px;
    background: var(--whitw, #f8f8f8);
    padding: 16px;
    gap: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-direction: column;
  }
</style>
